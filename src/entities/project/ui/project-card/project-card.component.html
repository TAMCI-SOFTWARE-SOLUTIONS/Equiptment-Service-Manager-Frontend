<button
  pRipple
  type="button"
  [disabled]="!clickable()"
  (click)="handleCardClick()"
  class="group w-full overflow-hidden rounded-xl border-2 bg-white text-left transition-all duration-300"
  [ngClass]="{
    'border-sky-500 shadow-lg': isSelected(),
    'border-gray-200 hover:border-sky-300 hover:shadow-md': !isSelected() && clickable(),
    'border-gray-200': !isSelected() && !clickable(),
    'cursor-pointer': clickable(),
    'cursor-default': !clickable()
  }">

  <!-- Banner Image -->
  <div class="relative h-40 overflow-hidden bg-gradient-to-br from-gray-50 to-gray-100">
    @if (bannerUrl()) {
      <img
        [src]="bannerUrl()!"
        [alt]="project().name"
        class="h-full w-full object-cover transition-transform duration-500"
        [ngClass]="{'group-hover:scale-110': clickable()}" />
      <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"></div>
    } @else {
      <div class="flex h-full w-full items-center justify-center bg-gradient-to-br from-sky-400 to-cyan-500">
        <i class="pi pi-folder text-5xl text-white opacity-20"></i>
      </div>
    }

    <!-- Selected Badge -->
    @if (isSelected()) {
      <div class="absolute right-3 top-3">
        <div class="flex h-10 w-10 items-center justify-center rounded-full bg-sky-500 shadow-xl ring-4 ring-white">
          <i class="pi pi-check text-sm font-bold text-white"></i>
        </div>
      </div>
    }
  </div>

  <!-- Content -->
  <div class="p-5">
    <!-- Project Name -->
    <h3
      class="mb-1.5 text-lg font-semibold transition-colors duration-200 line-clamp-2"
      [ngClass]="{
        'text-sky-600': isSelected(),
        'text-gray-900 group-hover:text-sky-600': !isSelected() && clickable(),
        'text-gray-900': !isSelected() && !clickable()
      }">
      {{ project().name }}
    </h3>

    <!-- Project Code -->
    <p class="mb-4 font-mono text-sm text-gray-500">
      {{ project().code }}
    </p>

    <!-- Equipment Type Badges -->
    @if (project().allowedEquipmentTypes.length > 0) {
      <div class="mb-4 flex flex-wrap gap-2">
        @for (type of project().allowedEquipmentTypes; track type) {
          <span class="inline-flex items-center gap-1.5 rounded-full bg-sky-50 px-3 py-1 text-xs font-semibold text-sky-700 ring-1 ring-sky-200 transition-all duration-200"
                [ngClass]="{'bg-sky-100 ring-sky-300': isSelected()}">
            <i [class]="getEquipmentIcon(type) + ' text-xs'"></i>
            <span>{{ getEquipmentLabel(type) }}</span>
          </span>
        }
      </div>
    }

    <!-- Dates -->
    @if (project().startAt || project().completionAt) {
      <div class="mb-4 flex items-center gap-2 text-sm text-gray-600">
        <i class="pi pi-calendar text-xs"></i>
        <span>
          @if (project().startAt) {
            {{ formatDate(project().startAt) }}
          } @else {
            <span class="text-gray-400">Sin fecha inicio</span>
          }
          @if (project().completionAt) {
            <span class="mx-1">-</span>
            {{ formatDate(project().completionAt) }}
          }
        </span>
      </div>
    }

    <!-- Description -->
    @if (project().description) {
      <div>
        <div
          class="overflow-hidden text-sm text-gray-600 transition-all duration-300"
          [class.line-clamp-2]="!isDescriptionExpanded()"
          [class.line-clamp-none]="isDescriptionExpanded()">
          <p>{{ project().description }}</p>
        </div>

        <!-- Toggle Button -->
        @if (project().description.length > 100) {
          <button
            type="button"
            (click)="toggleDescription($event)"
            class="mt-2 inline-flex items-center gap-1 text-xs font-semibold text-sky-600 transition-colors hover:text-sky-700">
            <span>{{ isDescriptionExpanded() ? 'Ver menos' : 'Ver m√°s' }}</span>
            <i class="pi text-xs" [ngClass]="isDescriptionExpanded() ? 'pi-chevron-up' : 'pi-chevron-down'"></i>
          </button>
        }
      </div>
    }
  </div>
</button>
