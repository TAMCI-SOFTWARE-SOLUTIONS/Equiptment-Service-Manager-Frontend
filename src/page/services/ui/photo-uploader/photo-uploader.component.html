<div class="space-y-4">
  <p class="font-semibold text-gray-700">{{ label }} ({{ files.length }} / {{ maxFiles }})</p>

  @if (canShowUpload) {
    <div class="flex items-center gap-3">
      <button
        pButton
        type="button"
        [label]="files.length === 0 ? 'Subir Foto' : 'Subir Otra'"
        icon="pi pi-upload"
        [disabled]="isLoading"
        (click)="fileInput.click()">
      </button>

      <button
        pButton
        type="button"
        label="Cámara"
        icon="pi pi-camera"
        [disabled]="isLoading"
        (click)="onOpenCamera.emit(uploadType)"
        class="p-button-outlined">
      </button>

      @if (isLoading) {
        <p-progressSpinner styleClass="w-6 h-6" strokeWidth="6"></p-progressSpinner>
        <span class="text-sm text-gray-500">Procesando...</span>
      }

      <input
        #fileInput
        type="file"
        class="hidden"
        accept="image/*"
        [multiple]="maxFiles > 1"
        (change)="onFileSelect($event)">
    </div>
  } @else {
    <div class="rounded-md border border-blue-200 bg-blue-50 p-3 text-sm text-blue-700">
      <i class="pi pi-info-circle mr-2"></i>
      Has alcanzado el límite de {{ maxFiles }} fotos.
    </div>
  }

  @if (files.length > 0) {
    <div class="mt-4 space-y-2">
      @for (file of files; track file.fileEntity.id) {
        <div class="flex items-center justify-between gap-3 rounded-md border border-gray-200 bg-white p-3 shadow-sm">
          <div class="flex min-w-0 flex-1 items-center gap-3">
            <i class="pi pi-image text-xl text-gray-500"></i>
            <div class="min-w-0 flex-1">
              <p class="truncate font-medium text-gray-800" [pTooltip]="file.fileEntity.originalName">
                {{ file.fileEntity.originalName }}
              </p>
              <p class="text-sm text-gray-500">
                {{ formatSize(file.fileEntity.size) }}
              </p>
            </div>
          </div>
          <div class="flex flex-shrink-0 items-center gap-1">
            <button pButton type="button" icon="pi pi-eye" class="p-button-text p-button-secondary" (click)="preview(file.fileEntity)" pTooltip="Previsualizar"></button>
            <button pButton type="button" icon="pi pi-trash" class="p-button-text p-button-danger" (click)="remove(file.fileEntity.id)" pTooltip="Eliminar"></button>
          </div>
        </div>
      }
    </div>
  }
</div>
