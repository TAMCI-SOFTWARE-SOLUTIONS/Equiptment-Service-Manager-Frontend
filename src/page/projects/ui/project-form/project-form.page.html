<div class="flex h-full flex-col bg-gray-50">

  <!-- Header -->
  <header class="shrink-0 border-b border-gray-200 bg-white px-4 py-4 lg:px-8">
    <div class="mx-auto max-w-4xl">
      <div class="flex items-center justify-between gap-4">
        <div class="flex-1">
          <h1 class="text-xl font-bold text-gray-900 lg:text-2xl">
            {{ isEditMode ? 'Editar Proyecto' : 'Nuevo Proyecto' }}
          </h1>
          <p class="mt-1 text-sm text-gray-600">
            Paso {{ store.currentStep() }} de {{ store.totalSteps() }}
          </p>
        </div>

        <button
          pRipple
          type="button"
          (click)="onCancel()"
          [disabled]="store.isSubmitting()"
          class="flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 transition-all hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-50">
          <i class="pi pi-times text-base"></i>
        </button>
      </div>

      <!-- Progress Bar -->
      <div class="mt-4 h-2 overflow-hidden rounded-full bg-gray-200">
        <div
          class="h-full bg-gradient-to-r from-sky-500 to-cyan-500 transition-all duration-500 ease-out"
          [style.width.%]="store.progress()">
        </div>
      </div>
    </div>
  </header>

  <!-- Content -->
  <main class="flex-1 overflow-auto px-4 py-6 lg:px-8">
    <div class="mx-auto max-w-4xl">

      <!-- Error Global -->
      @if (store.error()) {
        <div class="mb-6 flex items-start gap-3 rounded-lg border border-red-200 bg-red-50 p-4 animate-in fade-in slide-in-from-top-2 duration-300">
          <i class="pi pi-exclamation-circle mt-0.5 text-lg text-red-600"></i>
          <div class="flex-1">
            <p class="font-medium text-red-800">Error</p>
            <p class="mt-1 text-sm text-red-700">{{ store.error() }}</p>
          </div>
          <button
            type="button"
            (click)="store.clearError()"
            class="rounded-md p-1.5 text-red-600 transition-colors hover:bg-red-100">
            <i class="pi pi-times text-sm"></i>
          </button>
        </div>
      }

      <div class="grid gap-6 lg:grid-cols-12">

        <!-- Stepper Sidebar (Desktop) -->
        <aside class="hidden lg:col-span-3 lg:block">
          <div class="sticky top-6 space-y-2">
            @for (step of [1, 2]; track step) {
              <button
                type="button"
                (click)="onGoToStep(step)"
                [disabled]="step > 1 && !isStepCompleted(1)"
                class="flex w-full items-center gap-3 rounded-lg p-3 text-left transition-all disabled:cursor-not-allowed disabled:opacity-50"
                [class.bg-sky-50]="isStepActive(step)"
                [class.border-2]="isStepActive(step)"
                [class.border-sky-500]="isStepActive(step)"
                [class.hover:bg-gray-50]="!isStepActive(step)">

                <div class="flex h-10 w-10 shrink-0 items-center justify-center rounded-full transition-all"
                     [class.bg-sky-500]="isStepActive(step)"
                     [class.text-white]="isStepActive(step)"
                     [class.bg-sky-100]="!isStepActive(step) && isStepCompleted(step)"
                     [class.text-sky-600]="!isStepActive(step) && isStepCompleted(step)"
                     [class.bg-gray-100]="!isStepActive(step) && !isStepCompleted(step)"
                     [class.text-gray-400]="!isStepActive(step) && !isStepCompleted(step)">
                  @if (isStepCompleted(step) && !isStepActive(step)) {
                    <i class="pi pi-check text-base font-bold"></i>
                  } @else {
                    <i class="text-base pi" [ngClass]="getStepIcon(step)"></i>
                  }
                </div>

                <div class="flex-1">
                  <p class="text-sm font-semibold"
                     [class.text-sky-900]="isStepActive(step)"
                     [class.text-gray-900]="!isStepActive(step) && isStepCompleted(step)"
                     [class.text-gray-600]="!isStepActive(step) && !isStepCompleted(step)">
                    {{ getStepTitle(step) }}
                  </p>
                  @if (isStepActive(step)) {
                    <p class="mt-0.5 text-xs text-sky-600">
                      En progreso
                    </p>
                  } @else if (isStepCompleted(step)) {
                    <p class="mt-0.5 text-xs text-gray-500">
                      Completado
                    </p>
                  }
                </div>

                @if (isStepActive(step)) {
                  <i class="pi pi-chevron-right text-sky-600"></i>
                }
              </button>
            }
          </div>
        </aside>

        <!-- Stepper Pills (Mobile) -->
        <div class="flex items-center gap-2 overflow-x-auto pb-2 lg:hidden">
          @for (step of [1, 2]; track step) {
            <button
              type="button"
              (click)="onGoToStep(step)"
              [disabled]="step > 1 && !isStepCompleted(1)"
              class="flex shrink-0 items-center gap-2 rounded-full px-4 py-2 text-sm font-medium transition-all disabled:cursor-not-allowed disabled:opacity-50"
              [class.bg-sky-500]="isStepActive(step)"
              [class.text-white]="isStepActive(step)"
              [class.shadow-lg]="isStepActive(step)"
              [class.bg-sky-100]="!isStepActive(step) && isStepCompleted(step)"
              [class.text-sky-700]="!isStepActive(step) && isStepCompleted(step)"
              [class.bg-gray-100]="!isStepActive(step) && !isStepCompleted(step)"
              [class.text-gray-600]="!isStepActive(step) && !isStepCompleted(step)">
              @if (isStepCompleted(step) && !isStepActive(step)) {
                <i class="pi pi-check text-xs font-bold"></i>
              } @else {
                <i class="text-xs pi" [ngClass]="getStepIcon(step)"></i>
              }
              <span>{{ getStepTitle(step) }}</span>
            </button>
          }
        </div>

        <!-- Form Content -->
        <div class="lg:col-span-9">
          <div class="rounded-xl border border-gray-200 bg-white shadow-sm">

            <!-- Step Header -->
            <div class="border-b border-gray-200 p-6">
              <div class="flex items-start gap-4">
                <div class="flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-gradient-to-br from-sky-400 to-cyan-500">
                  <i class="text-xl text-white pi" [ngClass]="getStepIcon(store.currentStep())"></i>
                </div>
                <div class="flex-1">
                  <h2 class="text-lg font-semibold text-gray-900">
                    {{ store.currentStepTitle() }}
                  </h2>
                  <p class="mt-1 text-sm text-gray-600">
                    {{ store.currentStepDescription() }}
                  </p>
                </div>
              </div>
            </div>

            <!-- Step Content -->
            <div class="p-6">

              <!-- STEP 1: Informaci√≥n del Proyecto -->
              @if (store.currentStep() === 1) {
                <div class="space-y-6">

                  <!-- Nombre del Proyecto -->
                  <div class="space-y-2">
                    <label for="name" class="block text-sm font-medium text-gray-700">
                      Nombre del Proyecto
                      <span class="text-red-500">*</span>
                    </label>
                    <input
                      id="name"
                      type="text"
                      [value]="store.formData().name"
                      (input)="onNameChange($any($event.target).value)"
                      [disabled]="store.isSubmitting()"
                      placeholder="Ej: Sistema de Control Principal"
                      class="block w-full rounded-lg border py-2.5 px-3.5 text-sm text-gray-900 placeholder-gray-400 transition-all focus:outline-none focus:ring-2 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500"
                      [ngClass]="{
                        'border-red-500 focus:border-red-500 focus:ring-red-500/20': store.validationErrors().name,
                        'border-gray-300 focus:border-sky-500 focus:ring-sky-500/20': !store.validationErrors().name
                      }">

                    @if (store.validationErrors().name) {
                      <p class="mt-1.5 flex items-start text-xs text-red-600">
                        <i class="pi pi-exclamation-circle mr-1.5 mt-0.5 text-xs"></i>
                        {{ store.validationErrors().name }}
                      </p>
                    }
                  </div>

                  <!-- C√≥digo del Proyecto -->
                  <div class="space-y-2">
                    <label for="code" class="block text-sm font-medium text-gray-700">
                      C√≥digo del Proyecto
                      <span class="text-red-500">*</span>
                    </label>
                    <div class="flex gap-2">
                      <input
                        id="code"
                        type="text"
                        [value]="store.formData().code"
                        (input)="onCodeChange($any($event.target).value)"
                        (blur)="onCheckCodeAvailability()"
                        [disabled]="store.isSubmitting()"
                        placeholder="PRJ-2025-01"
                        maxlength="10"
                        class="block flex-1 rounded-lg border py-2.5 px-3.5 font-mono text-sm text-gray-900 placeholder-gray-400 transition-all focus:outline-none focus:ring-2 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500"
                        [ngClass]="{
                          'border-red-500 focus:border-red-500 focus:ring-red-500/20': store.validationErrors().code,
                          'border-gray-300 focus:border-sky-500 focus:ring-sky-500/20': !store.validationErrors().code
                        }">

                      <button
                        pRipple
                        type="button"
                        (click)="onGenerateCode()"
                        disabled
                        class="flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 transition-all hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-50">
                        <i class="pi pi-sparkles text-sm"></i>
                        <span class="hidden sm:inline">Generar</span>
                      </button>
                    </div>

                    @if (store.validationErrors().code) {
                      <p class="mt-1.5 flex items-start text-xs text-red-600">
                        <i class="pi pi-exclamation-circle mr-1.5 mt-0.5 text-xs"></i>
                        {{ store.validationErrors().code }}
                      </p>
                    } @else {
                      <p class="text-xs text-gray-500">
                        <i class="pi pi-info-circle mr-1"></i>
                        Debe tener exactamente 10 caracteres. Solo letras may√∫sculas, n√∫meros y guiones.
                      </p>
                    }

                    <div class="rounded-lg border border-sky-200 bg-sky-50 p-3">
                      <p class="text-xs text-sky-700">
                        <i class="pi pi-info-circle mr-1 text-sky-600"></i>
                        üöß La verificaci√≥n de disponibilidad y generaci√≥n autom√°tica de c√≥digo estar√° disponible pr√≥ximamente.
                      </p>
                    </div>
                  </div>

                  <!-- Descripci√≥n -->
                  <div class="space-y-2">
                    <label for="description" class="block text-sm font-medium text-gray-700">
                      Descripci√≥n
                      <span class="text-red-500">*</span>
                    </label>
                    <textarea
                      id="description"
                      rows="4"
                      [value]="store.formData().description"
                      (input)="onDescriptionChange($any($event.target).value)"
                      [disabled]="store.isSubmitting()"
                      placeholder="Describe el objetivo y alcance del proyecto..."
                      class="block w-full rounded-lg border py-2.5 px-3.5 text-sm text-gray-900 placeholder-gray-400 transition-all focus:outline-none focus:ring-2 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500"
                      [ngClass]="{
                        'border-red-500 focus:border-red-500 focus:ring-red-500/20': store.validationErrors().description,
                        'border-gray-300 focus:border-sky-500 focus:ring-sky-500/20': !store.validationErrors().description
                      }"></textarea>

                    @if (store.validationErrors().description) {
                      <p class="mt-1.5 flex items-start text-xs text-red-600">
                        <i class="pi pi-exclamation-circle mr-1.5 mt-0.5 text-xs"></i>
                        {{ store.validationErrors().description }}
                      </p>
                    } @else {
                      <p class="text-xs text-gray-500">
                        {{ store.formData().description.length }}/500 caracteres
                      </p>
                    }
                  </div>

                  <!-- Cliente -->
                  <div class="space-y-2">
                    <label for="client" class="block text-sm font-medium text-gray-700">
                      Cliente
                      <span class="text-red-500">*</span>
                    </label>

                    @if (store.isLoadingClients()) {
                      <div class="flex h-12 items-center justify-center rounded-lg border border-gray-300 bg-gray-50">
                        <i class="pi pi-spinner pi-spin text-sm text-gray-400"></i>
                      </div>
                    } @else {
                      <p-select
                        inputId="client"
                        [options]="clientOptions"
                        [(ngModel)]="store.formData().clientId"
                        (onChange)="onClientChange($event.value)"
                        optionLabel="label"
                        optionValue="value"
                        placeholder="Selecciona un cliente"
                        [disabled]="store.isSubmitting()"
                        [showClear]="false"
                        [filter]="true"
                        filterPlaceholder="Buscar cliente..."
                        [style]="{ width: '100%' }"
                        styleClass="w-full">
                      </p-select>
                    }

                    @if (store.validationErrors().clientId) {
                      <p class="mt-1.5 flex items-start text-xs text-red-600">
                        <i class="pi pi-exclamation-circle mr-1.5 mt-0.5 text-xs"></i>
                        {{ store.validationErrors().clientId }}
                      </p>
                    }
                  </div>

                </div>
              }

              <!-- STEP 2: Configuraci√≥n -->
              @if (store.currentStep() === 2) {
                <div class="space-y-6">

                  <!-- ‚úÖ AGREGAR ESTA SECCI√ìN COMPLETA -->
                  <!-- Tipo de Equipo Permitido -->
                  <div class="space-y-3">
                    <label class="block text-sm font-medium text-gray-700">
                      Tipo de Equipo Permitido
                      <span class="text-red-500">*</span>
                    </label>
                    <p class="text-xs text-gray-600">
                      Selecciona el tipo de equipo que se utilizar√° en este proyecto.
                    </p>

                    <div class="grid gap-4 sm:grid-cols-2">
                      @for (equipmentType of equipmentTypes; track equipmentType.value) {
                        <label
                          class="group relative cursor-pointer overflow-hidden rounded-xl border-2 bg-white transition-all hover:shadow-md"
                          [class.border-sky-500]="store.formData().allowedEquipmentType === equipmentType.value"
                          [class.bg-sky-50]="store.formData().allowedEquipmentType === equipmentType.value"
                          [class.border-gray-300]="store.formData().allowedEquipmentType !== equipmentType.value">

                          <input
                            type="radio"
                            name="equipmentType"
                            [value]="equipmentType.value"
                            [checked]="store.formData().allowedEquipmentType === equipmentType.value"
                            (change)="onEquipmentTypeChange(equipmentType.value)"
                            [disabled]="store.isSubmitting()"
                            class="sr-only">

                          <div class="p-6">
                            <div class="flex items-center justify-between">
                              <div class="flex h-12 w-12 items-center justify-center rounded-full text-2xl transition-all"
                                   [class.bg-sky-100]="store.formData().allowedEquipmentType !== equipmentType.value"
                                   [class.bg-sky-500]="store.formData().allowedEquipmentType === equipmentType.value">
                                  <span [class.grayscale]="store.formData().allowedEquipmentType !== equipmentType.value">
                                    {{ equipmentType.icon }}
                                  </span>
                              </div>

                              @if (store.formData().allowedEquipmentType === equipmentType.value) {
                                <div class="flex h-6 w-6 items-center justify-center rounded-full bg-sky-500">
                                  <i class="pi pi-check text-xs font-bold text-white"></i>
                                </div>
                              }
                            </div>

                            <h3 class="mt-4 text-base font-semibold transition-colors"
                                [class.text-sky-900]="store.formData().allowedEquipmentType === equipmentType.value"
                                [class.text-gray-900]="store.formData().allowedEquipmentType !== equipmentType.value">
                              {{ equipmentType.label }}
                            </h3>
                            <p class="mt-1 text-xs text-gray-600">
                              {{ equipmentType.description }}
                            </p>
                          </div>

                          <div class="absolute inset-0 border-2 border-sky-500 opacity-0 transition-opacity"
                               [class.opacity-100]="store.formData().allowedEquipmentType === equipmentType.value">
                          </div>
                        </label>
                      }
                    </div>

                    @if (store.validationErrors().allowedEquipmentType) {
                      <p class="mt-1.5 flex items-start text-xs text-red-600">
                        <i class="pi pi-exclamation-circle mr-1.5 mt-0.5 text-xs"></i>
                        {{ store.validationErrors().allowedEquipmentType }}
                      </p>
                    }
                  </div>

                  <!-- Fechas (Opcional) -->
                  <div class="grid gap-6 sm:grid-cols-2">
                    <!-- Fecha de Inicio -->
                    <div class="space-y-2">
                      <label for="startDate" class="block text-sm font-medium text-gray-700">
                        Fecha de Inicio
                        <span class="text-xs font-normal text-gray-500">(Opcional)</span>
                      </label>
                      <input
                        id="startDate"
                        type="date"
                        [value]="formatDate(store.formData().startAt)"
                        (change)="onStartDateChange($event)"
                        [disabled]="store.isSubmitting()"
                        class="block w-full rounded-lg border py-2.5 px-3.5 text-sm text-gray-900 transition-all focus:outline-none focus:ring-2 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500"
                        [ngClass]="{
                          'border-red-500 focus:border-red-500 focus:ring-red-500/20': store.validationErrors().startAt,
                          'border-gray-300 focus:border-sky-500 focus:ring-sky-500/20': !store.validationErrors().startAt
                        }">

                      @if (store.validationErrors().startAt) {
                        <p class="mt-1.5 flex items-start text-xs text-red-600">
                          <i class="pi pi-exclamation-circle mr-1.5 mt-0.5 text-xs"></i>
                          {{ store.validationErrors().startAt }}
                        </p>
                      }
                    </div>

                    <!-- Fecha de Finalizaci√≥n -->
                    <div class="space-y-2">
                      <label for="completionDate" class="block text-sm font-medium text-gray-700">
                        Fecha de Finalizaci√≥n
                        <span class="text-xs font-normal text-gray-500">(Opcional)</span>
                      </label>
                      <input
                        id="completionDate"
                        type="date"
                        [value]="formatDate(store.formData().completionAt)"
                        (change)="onCompletionDateChange($event)"
                        [disabled]="store.isSubmitting()"
                        class="block w-full rounded-lg border py-2.5 px-3.5 text-sm text-gray-900 transition-all focus:outline-none focus:ring-2 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500"
                        [ngClass]="{
                          'border-red-500 focus:border-red-500 focus:ring-red-500/20': store.validationErrors().completionAt,
                          'border-gray-300 focus:border-sky-500 focus:ring-sky-500/20': !store.validationErrors().completionAt
                        }">

                      @if (store.validationErrors().completionAt) {
                        <p class="mt-1.5 flex items-start text-xs text-red-600">
                          <i class="pi pi-exclamation-circle mr-1.5 mt-0.5 text-xs"></i>
                          {{ store.validationErrors().completionAt }}
                        </p>
                      }
                    </div>
                  </div>

                  <!-- Banner del Proyecto -->
                  <div class="space-y-2">
                    <label class="block text-sm font-medium text-gray-700">
                      Banner del Proyecto
                      <span class="text-xs font-normal text-gray-500">(Opcional)</span>
                    </label>
                    <p class="text-xs text-gray-600">
                      Imagen representativa del proyecto. Se mostrar√° en el detalle del proyecto.
                    </p>

                    @if (store.bannerPreviewUrl()) {
                      <!-- Preview del banner -->
                      <div class="space-y-3">
                        <div class="relative overflow-hidden rounded-lg border-2 border-sky-200">
                          <img
                            [src]="store.bannerPreviewUrl()"
                            alt="Preview"
                            class="h-48 w-full object-cover">

                          <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>

                          <div class="absolute bottom-3 left-3 right-3">
                            <p class="text-sm font-medium text-white drop-shadow-lg">
                              {{ store.formData().bannerFile?.name }}
                            </p>
                            <p class="mt-0.5 text-xs text-white/90 drop-shadow-lg">
                              {{ formatFileSize(store.formData().bannerFile?.size || 0) }} MB
                            </p>
                          </div>
                        </div>

                        <button
                          pRipple
                          type="button"
                          (click)="onClearBanner()"
                          [disabled]="store.isSubmitting() || store.isUploadingBanner()"
                          class="flex w-full items-center justify-center gap-2 rounded-lg border border-red-300 bg-red-50 px-4 py-2.5 text-sm font-medium text-red-700 transition-all hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-50">
                          <i class="pi pi-trash text-sm"></i>
                          Eliminar banner
                        </button>
                      </div>
                    } @else {
                      <!-- Upload button -->
                      <label
                        class="group relative flex cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed border-gray-300 bg-white p-8 transition-all hover:border-sky-400 hover:bg-sky-50"
                        [class.cursor-not-allowed]="store.isSubmitting()"
                        [class.opacity-50]="store.isSubmitting()">

                        <div class="flex h-16 w-16 items-center justify-center rounded-full bg-gradient-to-br from-sky-100 to-cyan-100 transition-all group-hover:from-sky-200 group-hover:to-cyan-200">
                          <i class="pi pi-image text-3xl text-sky-600"></i>
                        </div>

                        <p class="mt-4 text-sm font-medium text-gray-900">
                          Seleccionar banner
                        </p>
                        <p class="mt-1 text-xs text-gray-600">
                          PNG, JPG, JPEG o WEBP hasta 5MB
                        </p>
                        <p class="mt-2 text-xs text-gray-500">
                          Recomendado: 1920x400px
                        </p>

                        <input
                          type="file"
                          accept="image/*"
                          (change)="onBannerSelect($event)"
                          [disabled]="store.isSubmitting()"
                          class="sr-only">
                      </label>
                    }

                    @if (store.validationErrors().bannerFile) {
                      <p class="mt-1.5 flex items-start text-xs text-red-600">
                        <i class="pi pi-exclamation-circle mr-1.5 mt-0.5 text-xs"></i>
                        {{ store.validationErrors().bannerFile }}
                      </p>
                    }
                  </div>

                  <!-- Resumen -->
                  @if (store.isStep2Valid()) {
                    <div class="rounded-xl border-2 border-dashed border-sky-200 bg-sky-50/50 p-6">
                      <div class="mb-3 flex items-center gap-2 text-sm font-medium text-sky-700">
                        <i class="pi pi-eye text-base"></i>
                        <span>Resumen del proyecto</span>
                      </div>

                      <div class="rounded-lg border border-sky-200 bg-white p-4">
                        <dl class="space-y-3">
                          <div>
                            <dt class="text-xs font-medium uppercase tracking-wider text-gray-500">
                              Nombre
                            </dt>
                            <dd class="mt-1 text-sm font-semibold text-gray-900">
                              {{ store.formData().name }}
                            </dd>
                          </div>

                          <div>
                            <dt class="text-xs font-medium uppercase tracking-wider text-gray-500">
                              C√≥digo
                            </dt>
                            <dd class="mt-1 font-mono text-sm font-semibold text-gray-900">
                              {{ store.formData().code }}
                            </dd>
                          </div>

                          <div>
                            <dt class="text-xs font-medium uppercase tracking-wider text-gray-500">
                              Tipo de Equipo
                            </dt>
                            <dd class="mt-1">
                              @if (store.formData().allowedEquipmentType) {
                                @for (et of equipmentTypes; track et.value) {
                                  @if (et.value === store.formData().allowedEquipmentType) {
                                    <span class="inline-flex items-center gap-1.5 rounded-full bg-sky-100 px-3 py-1 text-xs font-semibold text-sky-700">
                                      <span>{{ et.icon }}</span>
                                      <span>{{ et.label }}</span>
                                    </span>
                                  }
                                }
                              } @else {
                                <span class="text-xs text-gray-500 italic">No seleccionado</span>
                              }
                            </dd>
                          </div>

                          @if (store.formData().startAt) {
                            <div>
                              <dt class="text-xs font-medium uppercase tracking-wider text-gray-500">
                                Fecha de Inicio
                              </dt>
                              <dd class="mt-1 text-xs text-gray-600">
                                <i class="pi pi-calendar mr-1 text-xs"></i>
                                {{ store.formData().startAt | date:'dd/MM/yyyy' }}
                              </dd>
                            </div>
                          }

                          @if (store.formData().completionAt) {
                            <div>
                              <dt class="text-xs font-medium uppercase tracking-wider text-gray-500">
                                Fecha de Finalizaci√≥n
                              </dt>
                              <dd class="mt-1 text-xs text-gray-600">
                                <i class="pi pi-calendar mr-1 text-xs"></i>
                                {{ store.formData().completionAt | date:'dd/MM/yyyy' }}
                              </dd>
                            </div>
                          }

                          @if (store.bannerPreviewUrl()) {
                            <div>
                              <dt class="text-xs font-medium uppercase tracking-wider text-gray-500">
                                Banner
                              </dt>
                              <dd class="mt-1 flex items-center gap-2 text-xs text-gray-600">
                                <i class="pi pi-check-circle text-green-600"></i>
                                <span>Banner incluido</span>
                              </dd>
                            </div>
                          }
                        </dl>
                      </div>
                    </div>
                  }

                </div>
              }

            </div>

            <!-- Step Actions -->
            <div class="border-t border-gray-200 p-4">
              <div class="flex items-center justify-between gap-3">

                <!-- Previous Button -->
                <button
                  pRipple
                  type="button"
                  (click)="onPrevious()"
                  [disabled]="store.currentStep() === 1 || store.isSubmitting()"
                  class="flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 transition-all hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50">
                  <i class="pi pi-arrow-left text-sm"></i>
                  <span>Anterior</span>
                </button>

                <!-- Next / Submit Button -->
                @if (store.currentStep() < store.totalSteps()) {
                  <button
                    pRipple
                    type="button"
                    (click)="onNext()"
                    [disabled]="!store.canGoNext() || store.isSubmitting()"
                    class="flex items-center gap-2 rounded-lg bg-gradient-to-r from-sky-500 to-cyan-500 px-5 py-2.5 text-sm font-semibold text-white shadow-lg shadow-sky-500/25 transition-all hover:shadow-xl hover:shadow-sky-500/40 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:from-gray-300 disabled:to-gray-300 disabled:shadow-none">
                    <span>Siguiente</span>
                    <i class="pi pi-arrow-right text-sm"></i>
                  </button>
                } @else {
                  <button
                    pRipple
                    type="button"
                    (click)="onSubmit()"
                    [disabled]="!store.canSubmit()"
                    class="flex items-center gap-2 rounded-lg bg-gradient-to-r from-sky-500 to-cyan-500 px-5 py-2.5 text-sm font-semibold text-white shadow-lg shadow-sky-500/25 transition-all hover:shadow-xl hover:shadow-sky-500/40 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:from-gray-300 disabled:to-gray-300 disabled:shadow-none">
                    @if (store.isSubmitting()) {
                      <i class="pi pi-spinner pi-spin text-sm"></i>
                      <span>{{ store.isUploadingBanner() ? 'Subiendo banner...' : 'Creando proyecto...' }}</span>
                    } @else {
                      <i class="pi pi-check text-sm"></i>
                      <span>{{ isEditMode ? 'Guardar Cambios' : 'Crear Proyecto' }}</span>
                    }
                  </button>
                }

              </div>
            </div>

          </div>
        </div>

      </div>

    </div>
  </main>

</div>
